/*
 * sci_buffer.h
 *
 *  Created on: 2018?3?31?
 *      Author: xhy
 *
 * SCI_BUFFER?????????SCI_BUFFER??????????RX_BUFFER?TX_BUFFER??????????????
 *
 * ??????????????RX_BUFFER????????????????
 * ?TX_BUFFER?????????????????????????????TX_BUFFER????TX_FIFO???
 *
 * ??SCI????RX_FIFO?TX_FIFO????????????????????????????????????
 *
 */

#ifndef __SCI_BUFFER_H_
#define __SCI_BUFFER_H_


#include "string.h"
#include "p33FJ32MC204.h"


//??RX_BUFFER?TX_BUFFER??
#define RX_BUFFER_LEN 128
#define TX_BUFFER_LEN 128

//??SCI_BUFFER?????
//?????
//RX_BUFFER
//TX_BUFFER
//RX_BUFFER(?)??
//TX_BUFFER???
//TX_BUFFER???      ??TX_BUFFER???????????
typedef struct _SCI_Buffer_Obj_
{
    volatile int RX_Buffer[RX_BUFFER_LEN];
    volatile int TX_Buffer[TX_BUFFER_LEN];
    volatile int RX_Buffer_Index;
    volatile int TX_Buffer_Head_Index;
    volatile int TX_Buffer_Tail_Index;
}SCI_Buffer_Obj;

//??SCI_BUFFER?????
typedef struct _SCI_Buffer_Obj_ *SCI_Buffer_Handle;

//???SCI_BUFFER???????
SCI_Buffer_Handle SCI_Buffer_init(void *pMemory);

//RX_BUFFER??????
int RX_Buffer_WriteChar(SCI_Buffer_Handle sci_buffer_handle, int RX_Char);
//RX_BUFFER????????
int RX_Buffer_DeleteLastChar(SCI_Buffer_Handle sci_buffer_handle);
//RX_BUFFER????n???
int RX_Buffer_DeleteLastNChars(SCI_Buffer_Handle sci_buffer_handle, int n);
//RX_BUFFER??
void RX_Buffer_Flush(SCI_Buffer_Handle sci_buffer_handle);
//RX_BUFFER??????
char* RX_Buffer_PickLine(SCI_Buffer_Handle sci_buffer_handle);

//TX_BUFFER??????
int TX_Buffer_WriteChar(SCI_Buffer_Handle sci_buffer_handle, int TX_Char);
//TX_BUFFER??N???
int TX_Buffer_WriteChars(SCI_Buffer_Handle sci_buffer_handle, char *TX_msg, int len);
//TX_BUFFER?????
int TX_Buffer_WriteString(SCI_Buffer_Handle sci_buffer_handle, const char *TX_msg);
//TX_BUFFER?????
int TX_Buffer_OverflowPreCheck(SCI_Buffer_Handle sci_buffer_handle, int len);
//?TX_BUFFER???????TX_FIFO?
int TX_Buffer_Export2TX_FIFO(SCI_Buffer_Handle sci_buffer_handle, int TX_FIFO_Level);
//??TX_BUFFER????
int TX_Buffer_isEmpty(SCI_Buffer_Handle sci_buffer_handle);


#endif /* SCI_BUFFER_H_ */
